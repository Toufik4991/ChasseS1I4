<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pendu - Borne-Incendie</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Rye&display=swap');

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: #111;
      font-family: Arial, sans-serif;
      color: white;
      margin: 0;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 20px;
    }

    #wordDisplay {
      font-size: 36px;
      letter-spacing: 10px;
      margin-bottom: 10px;
      min-height: 50px;
    }

    #triesLeft {
      font-size: 20px;
      margin-bottom: 20px;
      color: #ff6b00;
    }

    #keyboard {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 500px;
    }

    .key {
      width: 40px;
      height: 40px;
      margin: 5px;
      text-align: center;
      line-height: 40px;
      border: 1px solid #555;
      border-radius: 5px;
      cursor: pointer;
      user-select: none;
      background: white;
      color: black;
      font-weight: bold;
      transition: all 0.2s;
    }

    .key.used {
      background: #ff4444;
      color: white;
      cursor: default;
      opacity: 0.6;
    }

    .key.correct {
      background: #00ff00;
      color: black;
      cursor: default;
    }

    #hangman {
      margin: 20px;
      background: #222;
      border-radius: 10px;
    }

    #winMessage {
      font-size: 64px;
      font-family: 'Rye', cursive;
      color: orange;
      text-align: center;
      display: none;
      position: relative;
      margin-top: 20px;
      text-shadow:
        0 0 10px #ff6b00,
        0 0 20px #ff6b00,
        0 0 30px #ff0000,
        0 0 40px #ff8c00;
    }

    .flame {
      position: absolute;
      pointer-events: none;
      animation: rise 1s infinite linear;
      z-index: 10;
    }

    @keyframes rise {
      0% { transform: translate(0,0) scale(1); opacity: 1;}
      100% { transform: translate(0,-50px) scale(1.5); opacity: 0;}
    }

    span.green { color: lime; font-weight: bold; }
    span.fixed { color: white; font-weight: bold; margin: 0 5px; }
  </style>
</head>
<body>

<h1>Jeu du Pendu</h1>
<div id="wordDisplay"></div>
<div id="triesLeft">Essais restants : 6</div>
<canvas id="hangman" width="150" height="200"></canvas>
<div id="keyboard"></div>
<div id="winMessage">AU FEUUUU ! ðŸ”¥</div>

<script>
// === Configuration ===
const phrase = "Borne-Incendie"; 
let guessed = [];
for(let c of phrase){ 
  guessed.push((c === "-" ? "-" : "_")); 
}

let wrongGuesses = 0;
const maxWrong = 6; // HarmonisÃ© avec le nombre d'Ã©tapes du dessin

const wordDisplay = document.getElementById("wordDisplay");
const keyboardDiv = document.getElementById("keyboard");
const hangmanCanvas = document.getElementById("hangman");
const ctx = hangmanCanvas.getContext("2d");
const winMessage = document.getElementById("winMessage");
const triesLeftDiv = document.getElementById("triesLeft");

ctx.lineWidth = 5;
ctx.strokeStyle = "white";

// === Clavier ===
const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const keysMap = {};
alphabet.split("").forEach(letter => {
  const key = document.createElement("div");
  key.textContent = letter;
  key.classList.add("key");
  key.addEventListener("click", () => guessLetter(letter, key));
  keyboardDiv.appendChild(key);
  keysMap[letter] = key;
});

// === Dessin du Pendu ===
function drawHangman(stage){
  ctx.clearRect(0,0,hangmanCanvas.width,hangmanCanvas.height);
  ctx.beginPath();
  if(stage > 0) { ctx.moveTo(10,190); ctx.lineTo(140,190); } // Base
  if(stage > 1) { ctx.moveTo(30,190); ctx.lineTo(30,20); ctx.lineTo(100,20); ctx.lineTo(100,40); } // Potence
  if(stage > 2) { ctx.stroke(); ctx.beginPath(); ctx.arc(100,50,15,0,Math.PI*2); } // TÃªte
  if(stage > 3) { ctx.moveTo(100,65); ctx.lineTo(100,120); } // Corps
  if(stage > 4) { ctx.moveTo(100,80); ctx.lineTo(70,100); ctx.moveTo(100,80); ctx.lineTo(130,100); } // Bras
  if(stage > 5) { ctx.moveTo(100,120); ctx.lineTo(75,160); ctx.moveTo(100,120); ctx.lineTo(125,160); } // Jambes
  ctx.stroke();
}

// === Affichage mot ===
function updateWordDisplay(){
  wordDisplay.innerHTML = guessed.map((c,i)=>{
    if(phrase[i] === "-") return `<span class="fixed">-</span>`;
    else if(c === "ðŸ˜º") return "ðŸ˜º";
    else return `<span class="green">${c}</span>`;
  }).join("");
  triesLeftDiv.textContent = "Essais restants : " + (maxWrong - wrongGuesses);
}

// === Gestion lettres ===
function guessLetter(letter, keyDiv){
  if(keyDiv.classList.contains("used") || keyDiv.classList.contains("correct") || wrongGuesses >= maxWrong) return;

  let correct = false;
  for(let i=0; i < phrase.length; i++){
    if(phrase[i].toUpperCase() === letter){
      correct = true;
      guessed[i] = "ðŸ˜º";
      keyDiv.classList.add("correct");
      
      // Petit effet : affiche le chat puis la lettre
      setTimeout(((index) => {
        return () => {
          guessed[index] = phrase[index];
          updateWordDisplay();
          checkWin();
        };
      })(i), 600);
    }
  }

  if(!correct){
    keyDiv.classList.add("used");
    wrongGuesses++;
    drawHangman(wrongGuesses);
    if(wrongGuesses >= maxWrong){
      setTimeout(() => alert("Perdu ! La rÃ©ponse Ã©tait : " + phrase), 200);
    }
  }
  updateWordDisplay();
}

// === VÃ©rifier victoire ===
function checkWin(){
  if(!guessed.includes("_") && !guessed.includes("ðŸ˜º")){
    winMessage.style.display = "block";
    keyboardDiv.style.pointerEvents = "none";
    spawnFlamesContinuous();
  }
}

// === Effet Flammes ===
function spawnFlamesContinuous(){
  function createFlame(){
    const flame = document.createElement("div");
    flame.className = "flame";
    flame.innerHTML = "ðŸ”¥";
    flame.style.left = Math.random() * winMessage.offsetWidth + "px";
    flame.style.top = Math.random() * winMessage.offsetHeight + "px";
    flame.style.fontSize = (15 + Math.random() * 20) + "px";
    flame.style.animationDuration = (0.5 + Math.random()) + "s";
    winMessage.appendChild(flame);
    setTimeout(() => flame.remove(), 1000);
  }
  setInterval(createFlame, 100);
}

// Initialisation
updateWordDisplay();
drawHangman(0);
</script>

</body>
</html>

