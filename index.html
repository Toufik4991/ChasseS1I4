<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Pendu - Flame Collector</title>
    <style>
        :root { --p: #ff4400; --s: #00ff88; }
        body { margin: 0; background: #050505; color: white; font-family: sans-serif; overflow: hidden; touch-action: none; text-align: center; }
        
        /* UI DU HAUT */
        #top-bar { height: 60px; display: flex; justify-content: space-around; align-items: center; background: #111; border-bottom: 2px solid #222; }
        .stat { font-weight: bold; font-size: 14px; }
        .stat span { color: var(--p); font-size: 20px; }

        /* ZONE MINI-JEU */
        #game-container { position: relative; height: 40vh; background: #000; overflow: hidden; border-bottom: 2px solid #222; }
        canvas { display: block; width: 100%; height: 100%; }

        /* ZONE PENDU */
        #pendu-container { height: 60vh; padding: 10px; display: flex; flex-direction: column; justify-content: space-between; }
        #wordDisplay { font-size: 24px; letter-spacing: 5px; color: var(--s); font-weight: bold; margin: 10px 0; }
        
        #keyboard { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .key { background: #222; padding: 12px 0; border-radius: 4px; font-size: 14px; font-weight: bold; border: 1px solid #333; }
        .key.used { opacity: 0.3; pointer-events: none; }
        .key.locked { color: #555; background: #111; }

        #buy-info { font-size: 12px; color: #aaa; margin-bottom: 5px; }
        .btn-buy { background: var(--p); color: white; border: none; padding: 5px 10px; border-radius: 4px; font-weight: bold; }

        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; z-index: 100; flex-direction: column; justify-content: center; align-items: center; }
    </style>
</head>
<body>

    <div id="top-bar">
        <div class="stat">VIES: <span id="lives">6</span></div>
        <div class="stat">Ã‰NERGIE: <span id="energy">0</span></div>
    </div>

    <div id="game-container">
        <canvas id="actionCanvas"></canvas>
    </div>

    <div id="pendu-container">
        <div id="buy-info">1 LETTRE = <span style="color:var(--p)">100 Ã‰NERGIE</span></div>
        <div id="wordDisplay">_ _ _ _ _ _ _ _ _ _ _ _ _</div>
        <div id="keyboard"></div>
    </div>

    <div id="overlay">
        <h1 id="res-title"></h1>
        <button onclick="location.reload()" style="padding:15px 30px; background:var(--p); color:white; border:none; border-radius:10px;">REJOUER</button>
    </div>

<script>
    // CONFIGURATION PENDU
    const phrase = "BORNE-INCENDIE";
    let guessed = Array.from(phrase).map(c => c === "-" ? "-" : "_");
    let energy = 0;
    let lives = 6;
    let gameActive = true;

    // CONFIGURATION MINI-JEU
    const canvas = document.getElementById('actionCanvas');
    const ctx = canvas.getContext('2d');
    let player = { x: 50, y: 50, r: 15 };
    let items = [];

    function init() {
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        player.x = canvas.width / 2;
        player.y = canvas.height / 2;

        // CrÃ©er clavier
        "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l => {
            const k = document.createElement('div');
            k.className = "key";
            k.textContent = l;
            k.onclick = () => buyLetter(l, k);
            document.getElementById('keyboard').appendChild(k);
        });

        updateUI();
        animate();
    }

    // INTERACTION MINI-JEU (Drag pour bouger)
    window.addEventListener('touchmove', e => {
        if(!gameActive) return;
        let rect = canvas.getBoundingClientRect();
        let touch = e.touches[0];
        if(touch.clientY < rect.bottom) {
            player.x = touch.clientX;
            player.y = touch.clientY - rect.top;
        }
    });

    function buyLetter(l, el) {
        if(energy < 100 || el.classList.contains('used')) return;
        
        energy -= 100;
        el.classList.add('used');
        let found = false;
        
        for(let i=0; i<phrase.length; i++) {
            if(phrase[i] === l) {
                guessed[i] = l;
                found = true;
            }
        }

        if(!found) {
            lives--;
            if(lives <= 0) endGame("BRÃ›LÃ‰... ðŸ’€");
        } else if(!guessed.includes("_")) {
            endGame("VICTOIRE ! ðŸ˜º");
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('energy').textContent = energy;
        document.getElementById('lives').textContent = lives;
        document.getElementById('wordDisplay').textContent = guessed.join(" ");
    }

    function animate() {
        if(!gameActive) return;
        ctx.fillStyle = 'rgba(0,0,0,0.3)';
        ctx.fillRect(0,0,canvas.width, canvas.height);

        // Dessin Joueur (Flamme)
        ctx.fillStyle = '#ff6600';
        ctx.beginPath();
        ctx.arc(player.x, player.y, player.r, 0, Math.PI*2);
        ctx.fill();

        // Spawn items
        if(Math.random() < 0.03) {
            items.push({ 
                x: canvas.width + 20, 
                y: Math.random() * canvas.height, 
                v: 3 + Math.random() * 4, 
                type: Math.random() > 0.3 ? 'point' : 'bad' 
            });
        }

        // Boucle Items
        for(let i = items.length-1; i>=0; i--) {
            let it = items[i];
            it.x -= it.v;
            
            ctx.fillStyle = it.type === 'point' ? '#00ff88' : '#00aaff';
            ctx.beginPath();
            ctx.arc(it.x, it.y, 8, 0, Math.PI*2);
            ctx.fill();

            // Collision
            let dist = Math.hypot(player.x - it.x, player.y - it.y);
            if(dist < player.r + 8) {
                if(it.type === 'point') energy += 20;
                else { lives--; updateUI(); if(lives <= 0) endGame("EXTINCT ! ðŸ’€"); }
                items.splice(i, 1);
                updateUI();
            }
        }
        requestAnimationFrame(animate);
    }

    function endGame(txt) {
        gameActive = false;
        document.getElementById('overlay').style.display = "flex";
        document.getElementById('res-title').textContent = txt;
    }

    init();
</script>
</body>
</html>
